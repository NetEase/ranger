<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE mapper PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN'
        'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>

<mapper namespace='org.apache.ranger.binding.metastore.ChangeMetastoreWriteDbEventListener.ChangeMetastoreMapper'>
    <insert id="insertImpalaMetastoreUpdateLog" parameterType="java.util.Map">
        INSERT INTO ${tableName}(record) VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (#{item})
        </foreach>
    </insert>
    <delete id="deleteImpalaMetastoreUpdateLog" parameterType="java.util.Map">
        DELETE FROM ${tableName} WHERE createTime &lt; '${createTime}'
    </delete>
    <update id="createImpalaMetastoreUpdateLog" parameterType="java.util.Map">
        CREATE TABLE IF NOT EXISTS ${tableName} (
            id bigint UNSIGNED NOT NULL PRIMARY KEY AUTO_INCREMENT,
            record varchar(1024) NOT NULL,
            createTime timestamp NULL DEFAULT CURRENT_TIMESTAMP
        ) ENGINE = INNODB AUTO_INCREMENT=1;
    </update>
</mapper>